         
# 实验报告：链式反应模拟

**学生姓名：** [杨非豪]

**学号：** [20231050039]

**完成日期：** [2025.6.25]

## 一、实验目的
参考《计算物理基础》8.8 节的MATLAB代码，编写链式反应模拟的python程序，实现链式反应的模拟逻辑，可视化反应过程，并分析不同参数对反应结果的影响。

## 二、实验原理
### 2.1 链式反应理论基础
阐述链式反应的基本概念、发生条件和主要过程，引用相关物理定律和公式。
基本概念：链式反应（Chain Reaction）是指一个反应过程中产生的粒子或能量能够引发后续反应，从而形成自持的、持续进行的反应过程。
发生条件：以中子引发的核裂变为例，条件为：1.可裂变材料；2.中子慢化；3.中子吸收可控；4.燃料合理布置，符合几何约束。
主要过程：1.单次裂变，释放中子继续发生反应；2.链式反应的维持，中子不断碰撞继续发生裂变；3.达到临界条件k=1，符合四因子公式k=fpηε ，即中子不逃逸概率达到平衡值
### 2.2 参考代码原理
简要说明《计算物理基础》8.8 节代码的核心逻辑和算法思路。
该MATLAB代码利用蒙特卡洛法模拟粒子在三维空间中的随机运动，并统计其进入单位立方体（边长为1）的概率，以此模拟链式反应中粒子（如中子）的增殖过程。最终输出反应密度 f = N/NO，表示有效反应发生的比例。
思路：先引入基础参数以初始化粒子位置，再使每个粒子生成两个可能的运动方向模拟粒子运动，再判断反应是否发生后输出结果。
## 三、实验环境
### 3.1 硬件环境
- 计算机型号：[FX507]
- CPU：[13th Gen Intel(R) Core(TM) i9-13900H]
- 内存：[15.6GB]

### 3.2 软件环境
- 操作系统：[Windows 11, version 23H2]
- 编程语言：[python]
- 开发工具：[pycharm]


## 四、实验步骤
### 4.1 链式反应模拟逻辑实现
详细描述实现链式反应模拟逻辑的步骤，给出关键代码片段。
```python
class ChainReactionSimulator:
    def __init__(self, M=1, S=1, NO=1000):
        self.M = M
        self.S = S
        self.NO = NO
        self.a = (M * S) ** (1 / 3)
        self.b = (M / S ** 2) ** (1 / 3)
        self.history = []

    def simulate_reaction(self):
        """模拟链式反应过程"""
        R = np.random.rand(9, self.NO)
        N = 0
        positions = []

        for k in range(self.NO):
            x0 = self.a * R[0, k]
            y0 = self.a * R[1, k]
            z0 = self.b * R[2, k]

            phi1 = 2 * np.pi * R[3, k]
            cthi1 = 2 * R[4, k] - 1
            d1 = R[5, k]

            phi2 = 2 * np.pi * R[6, k]
            cthi2 = 2 * R[7, k] - 1
            d2 = R[8, k]

            sthi1 = np.sqrt(1 - cthi1 ** 2)
            sthi2 = np.sqrt(1 - cthi2 ** 2)

            x1 = x0 + d1 * sthi1 * np.cos(phi1)
            y1 = y0 + d1 * sthi1 * np.sin(phi1)
            z1 = z0 + d1 * cthi1

            x2 = x0 + d2 * sthi2 * np.cos(phi2)
            y2 = y0 + d2 * sthi2 * np.sin(phi2)
            z2 = z0 + d2 * cthi2

            # 检查是否在单位立方体内
            in_cube1 = (0 <= x1 <= 1) and (0 <= y1 <= 1) and (0 <= z1 <= 1)
            in_cube2 = (0 <= x2 <= 1) and (0 <= y2 <= 1) and (0 <= z2 <= 1)

            if in_cube1 or in_cube2:
                N += 1
                positions.append((x1, y1, z1) if in_cube1 else (x2, y2, z2))

        self.f = N / self.NO
        self.positions = np.array(positions)
        return self.f
```
### 4.2 参数设置与实验运行
列出实验中设置的不同参数组合，描述如何改变参数并运行实验。
1.M=1,S=1,NO=1000,k=1，得到的f=0.6840
2.M=1.2,S=0.8,NO=5000,k=1, f=0.6080
参数改变：将M,S,NO三个参数都设置为输入形式，通过自定义输入来改变参数，再将输入值代入原先定义好的代码中运行
## 五、实验结论
总结实验结果，判断是否成功实现链式反应模拟和可视化，不同参数对反应结果的影响是否符合预期，提出改进实验的建议。
成功实现链式反应模拟和可视化，不同参数对反应结果的影响也符合预期，在M增大时，即中子逃逸减少时，f增大，S增大时，形状扁平化，中子逃逸增加，f减少，k>1时达到超临界，f也随之增大，NO增大时，统计波动降低，在NO大时结果更稳定。
建议：1.模型精细化，增加更多物理细节并优化几何模型；2.加入动态参数控制；3.增加理论误差分析，与四因子公式对比。


        
